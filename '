#include <cstdlib>
#include "blocktype.h"
#include "map.h"
#include "mapgenerator.h"
#include "noise.h"

MapGenerator::MapGenerator(unsigned int seed_) : seed(seed_) {}

void MapGenerator::getChunk(block_t* blocks, int posX, int posY)const {
	for (int x = 0; x < MAP_BLOCK_SIZE; x++) {
		for (int y = 0; y < MAP_BLOCK_SIZE; y++) {
			float h = perlin(Point2D((posX + x) / PI / 33.234, (posY + y) / 34.234 / PI), seed)
				* (WORLD_HEIGHT - 1);
			// int h = 1;
			// printf("%f ", h);
			for (int z = WORLD_HEIGHT - 1; z > h; z--)
				blocks[MapBlock::getID(x, y, z)] = AIR;
			for (int z = h; z >= 0; z--)
				blocks[MapBlock::getID(x, y, z)] = GRASS;
		}
	}
}




const MapGenerator generator(0x234D398F);
